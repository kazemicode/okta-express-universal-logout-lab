{
  "$schema": "https://aka.ms/codetour-schema",
  "title": "4 - Test with Okta",
  "steps": [
    {
      "title": "Test the endpoint",
      "description": "Now that the app has a secure, working UL endpoint. In this section, we'll test the endpoint with Okta.\n\nIn your Codespaces VM, on the PORTS tab set the [port visibility to public](https://docs.github.com/en/codespaces/developing-in-a-codespace/forwarding-ports-in-your-codespace). This allows requests from Okta to be forwarded to the public address provided by GitHub Codespaces."
    },
    {
      "title": "Provide revocation endpoint info to the Okta",
      "description": "Log in to your Okta dashboard, and under your UL App, go to the General tab. Within the General tab, look for the Logout > Global token revocation endpoint section and enable the `Okta system or admin initiates logout option` and add your GTR endpoint URL with your Codespace URL, for example, `https://expert-garbanzo-p5qv94qr7jf4vr-3000.app.github.dev/global-token-revocation`. Set the `Subject format` `to Email Identifier`, and Auth method to \"Signed JWT.\" Meaning Okta will send a request identifying the user with the email used to SSO into the OIDC webb app. Okta will authenticate to your UL endpoint with the secure OAuth method Signed JWT. And finally save your changes.\n\nNote: In your tokenValidator middleware be sure to update the `expectedAud` to match the base URL provided by Codespaces, it will look like [this](https://github.com/oktadev/okta-express-universal-logout-lab/blob/cd7e9473c7a6fc6c8eec0ebcd9183b7fe49054b9/app.js#L59)."
    },
    {
      "title": "End a user's session through Okta",
      "description": "From the Admin Console, go to Directory > People, and find the user you whose session you want to delete. For example, let's end the user session for \"trinity@whiterabbit.fake.\" To do this, click on their profile, click  More Actions, and then Clear User Sessions. Check the option `\"Also include logout enabled apps and Okta API tokens before clicking Clear and revoke\"`. You'll receive a sessions cleared and tokens revoked response.\n\nNow, navigate to the web app and click on the Okta icon to return to the main page. At this point, the user's session has been deleted, but the front end doesn't yet know about the user's state. "
    }
  ]
}